!function(){"use strict";if(window.io.sails.autoConnect=!1,window.WeMessenger)return console.log("Namespace already taken. Exiting script...");var a=window.WeMessenger={};a.initialize=function(b){var c=b||{};c.server=c.server||"http://localhost:1420",a.options=c;var d=window.document.createElement("div");d.setAttribute("id","we-mesenger"),window.document.getElementsByTagName("body")[0].appendChild(d);var e=a.App=Ember.Application.create({rootElement:d});e.deferReadiness(),e.set("LOG_TRANSITIONS",!0),e.set("LOG_TRANSITIONS_INTERNAL",!0),e.set("LOG_VIEW_LOOKUPS",!0),e.Router=Ember.Router.extend({location:"none"}),e.auth=Ember.Object.create({isAuthenticated:!1,authToken:null}),window.jQuery(window.document).ready(function(){var b="",d=c.authTokenName;return d="string"==typeof d||"wetoken",(b=c.wetoken?c.wetoken:$.cookie(d))?($.ajaxPrefilter(function(a){a.beforeSend||(a.beforeSend=function(a){a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","Bearer "+b)})}),void $.getJSON(a.options.server+"/account").done(function(a){e.get("auth").setProperties({isAuthenticated:!0,authToken:b}),window.io.socket=window.io.sails.connect(c.server),e.advanceReadiness()}).fail(function(a){console.log("WeMessenger:: No authenticated cookie nor token could be inferred"),console.log("WeMessenger:: Access Denied"),console.log("WeMessenger:: You gotta login first on CdP server"),e.set("auth.isAuthenticated",!1)})):(console.log("WeMessenger:: No authenticated cookie nor token could be inferred"),console.log("WeMessenger:: Access Denied"),console.log("WeMessenger:: You gotta login first on CdP server"),void e.set("auth.isAuthenticated",!1))})}}();